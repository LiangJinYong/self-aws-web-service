language: java
jdk:
    - openjdk8

branches:
    only:
        - master

# Travis CI Server's home
cache:
    directories:
        - '$HOME/.m2/repository'
        - '$HOME/.gradle'

script: "./gradlew clean build"

before_deploy:
    - zip -r self-aws-web-service *
    - mkdir -p deploy
    - mv self-aws-web-service.zip deploy/self-aws-web-service.zip

deploy:
    - provider: s3
    access_key_id: $AWS_ACCESS_KEY # Travis repo settings에 설정된 값
    secret_access_key: $AWS_SECRET_KEY  # Travis repo settings에 설정된 값
    bucket: freelec-springboot-build-ljy # S3 버킷
    region: ap-northease-2
    skip_cleanup: true
    aci: private # zip 파일 접근을private으로
    local_dir: deploy # before_deploy에서 생성한 디렉토리
    wait-until-deployed: true

# CI 실행완료시 메일로 알림
notifications:
    email:
        recipients:
            liangjy881@naver.com
